# Disable directory listing
Options -Indexes

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Deny direct access to all files except public/
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ public/$1 [L]
</IfModule>

# Protect sensitive files
<FilesMatch "^\.env">
    Order allow,deny
    Deny from all
</FilesMatch>

<FilesMatch "(composer\.json|composer\.lock|package\.json|yarn\.lock|phpunit\.xml|webpack\.mix\.js|artisan)">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block access to vendor folder
RedirectMatch 404 ^/vendor/.*$

# Extra protection for storage & bootstrap
RedirectMatch 404 ^/storage/.*$
RedirectMatch 404 ^/bootstrap/.*$
